<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/node-red-contrib-home-assistant-websocket/favicon.ico" size="32x32"><link rel="icon" href="/node-red-contrib-home-assistant-websocket/icon.svg" type="image/svg+xml"><title>Other functions | node-red-contrib-home-assistant-websocket</title><meta name="description" content="A suite of nodes that seamlessly integrates Home Assistant with Node-RED">
    <link rel="preload" href="/node-red-contrib-home-assistant-websocket/assets/style-BBu5kSqE.css" as="style"><link rel="stylesheet" href="/node-red-contrib-home-assistant-websocket/assets/style-BBu5kSqE.css">
    <link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/app-YEeKhUZS.js"><link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/functions.html-DLHtnhDw.js">
    <link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/FAQ.html-Do4xjgze.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-BD3GJbGp.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/actionable-notifications-subflow-for-android.html-3-ohBw_4.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/check-if-an-entity-was-turned-on-in-the-last-24-hours.html-C1Jv2sAG.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-by-label.html-DVj91KGb.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/expiration-date-monitor.html-Bbm88KXY.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-state_changed-events-based-on-area.html-DqA4DmMZ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/holiday-lights-scheduler-and-demo-mode-for-wled.html-CzLzBRZ5.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-BPE2uCR3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/motion-triggered-light.html-WFd5WIW3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/play-jellyfin-show-using-sentence-node.html-DRuouubo.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/saving-and-restoring-states.html-C6PSHqyS.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/starting-flow-after-home-assistant-restart.html-BBdn0F8I.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sun-events.html-BSdOcbIb.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/using-date-and-time-entities-to-trigger-flows.html-DxqbIypY.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/vacation-mode.html-QAIPCbtS.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/action.html-CDiLs-1U.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/conditionals.html-DMH5PCcE.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/development.html-CbpZTrzv.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/diagnostics.html-B_sxDljv.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/documentation.html-Du8tyWvX.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/first-automation.html-5c4FFEj7.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-iymxpFdi.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/migration.html-C3pNE5sQ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/mustache-templates.html-BWal_DCJ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/API.html-Dqkeu5V3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/action.html-CZ0LJ9Ij.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/binary-sensor.html-7oosGVvk.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/button.html-yIHf1oPv.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/config-server.html-BIil2deT.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-iHFezgLw.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device-config.html-CXzcls1u.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device.html-DbOoK4QU.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity-config.html-BwhwrhpU.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity.html-DayXlEcs.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-all.html-CQh4Lm7u.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-calendar.html-Bs4IYu3J.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-03MKsiUX.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/fire-event.html-qDQfXslD.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-entities.html-bq6sbI8Y.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-history.html-BoK0ZmJL.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-DzPNiZ8F.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/number.html-B5CdEAam.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/poll-state.html-sSxiFeNh.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/render-template.html-DJ6qq8CH.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/select.html-8lR19PYT.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-Dn0Mp5pJ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sentence.html-BGebd_0P.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/switch.html-CmB7VDmd.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/tag.html-BBX1S54D.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/text.html-lZBLAVtc.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time-entity.html-7AjPBHYZ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time.html-CDarQEqW.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-CUUUYVYo.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/update-config.html-Cui6T-ZK.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/wait-until.html-BcDtJ7IK.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/webhook.html-hISmgWCF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/zone.html-CO1xOAHe.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-BbtMXpSF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/action.html-Cp3SwWSz.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/change-node.html-D_Ljkhec.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-zIBDSnUw.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-B8cnsbDo.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-DZe_5E0B.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/switch-node.html-B7eQ-0aR.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-BZpMwcDs.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-D4ZnQ0Jw.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/exposed-nodes.html-BY0xkALI.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-DK7rZZZK.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-CjkW6fOr.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/jsonata-primer.html-nKnqCURa.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/404.html-BmYqQ_8Y.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/DocsOnly-D2IRDfzJ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/InfoPanelOnly-BGpQZbal.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/Scrubber-BHHYREa8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/node-red-contrib-home-assistant-websocket/"><img class="vp-site-logo" src="/node-red-contrib-home-assistant-websocket/logo-256.png" alt="node-red-contrib-home-assistant-websocket"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">node-red-contrib-home-assistant-websocket</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/guide/" aria-label="Guides"><!---->Guides<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/node/" aria-label="Nodes"><!---->Nodes<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/FAQ.html" aria-label="FAQ"><!---->FAQ<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/node-red-contrib-home-assistant-websocket/cookbook/" aria-label="Cookbook"><!---->Cookbook<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/scrubber/" aria-label="Scrubber"><!---->Scrubber<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/discussions" aria-label="Discussions" rel="noopener noreferrer" target="_blank"><!---->Discussions<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://discord.gg/QNdsZgNBnU" aria-label="Discord" rel="noopener noreferrer" target="_blank"><!---->Discord<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket" aria-label="Github" rel="noopener noreferrer" target="_blank"><!---->Github<!----></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/guide/" aria-label="Guides"><!---->Guides<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/node/" aria-label="Nodes"><!---->Nodes<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/FAQ.html" aria-label="FAQ"><!---->FAQ<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/node-red-contrib-home-assistant-websocket/cookbook/" aria-label="Cookbook"><!---->Cookbook<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/node-red-contrib-home-assistant-websocket/scrubber/" aria-label="Scrubber"><!---->Scrubber<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/discussions" aria-label="Discussions" rel="noopener noreferrer" target="_blank"><!---->Discussions<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://discord.gg/QNdsZgNBnU" aria-label="Discord" rel="noopener noreferrer" target="_blank"><!---->Discord<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket" aria-label="Github" rel="noopener noreferrer" target="_blank"><!---->Github<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">Cookbook <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><p tabindex="0" class="vp-sidebar-item active">JSONata <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/action.html" aria-label="Action Node JSONata Examples"><!---->Action Node JSONata Examples<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/change-node.html" aria-label="Change node"><!---->Change node<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/current-state.html" aria-label="Current State"><!---->Current State<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/events-state.html" aria-label="Events: state"><!---->Events: state<!----></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/functions.html" aria-label="Other functions"><!---->Other functions<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/sensor.html" aria-label="Sensor"><!---->Sensor<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/switch-node.html" aria-label="Switch node"><!---->Switch node<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/trigger-state.html" aria-label="Trigger: state"><!---->Trigger: state<!----></a><!----></li><!--]--></ul></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/motion-triggered-light.html" aria-label="Motion Triggered Light"><!---->Motion Triggered Light<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/saving-and-restoring-states.html" aria-label="Saving and Restoring States"><!---->Saving and Restoring States<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/get-state_changed-events-based-on-area.html" aria-label="Get state_changed Events Based on Area"><!---->Get state_changed Events Based on Area<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/sun-events.html" aria-label="Turn Light On/Off with Sunset/Sunrise"><!---->Turn Light On/Off with Sunset/Sunrise<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/vacation-mode.html" aria-label="Vacation Mode"><!---->Vacation Mode<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/expiration-date-monitor.html" aria-label="Expiration Date Monitor with notification"><!---->Expiration Date Monitor with notification<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/using-date-and-time-entities-to-trigger-flows.html" aria-label="Using Date and Time entities to trigger flows"><!---->Using Date and Time entities to trigger flows<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/check-if-an-entity-was-turned-on-in-the-last-24-hours.html" aria-label="Check if an entity was a certain state in the last 24 hours"><!---->Check if an entity was a certain state in the last 24 hours<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/starting-flow-after-home-assistant-restart.html" aria-label="Starting a flow after a Home Assistant restart"><!---->Starting a flow after a Home Assistant restart<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/holiday-lights-scheduler-and-demo-mode-for-wled.html" aria-label="Holiday lights scheduler and demo mode for WLED"><!---->Holiday lights scheduler and demo mode for WLED<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/node-red-contrib-home-assistant-websocket/cookbook/actionable-notifications-subflow-for-android.html" aria-label="Actionable Notifications Subflow for Android"><!---->Actionable Notifications Subflow for Android<!----></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="other-functions" tabindex="-1"><a class="header-anchor" href="#other-functions"><span>Other functions</span></a></h1><p>Several additional <strong>JSONata functions</strong> are provided for use within the WebSocket nodes. JSONata expressions are first &#39;prepared&#39; then &#39;executed&#39;, and the preparation first stage is used to bind the expression to extra Node-RED or other functions. This means that these WebSocket functions can <em>only</em> be used within a WebSocket node.</p><p><img src="/node-red-contrib-home-assistant-websocket/assets/jsonata_8_1-DHI1CMwN.png" alt="screenshot"></p><p>This example demonstrates the basic use of some of these functions.</p><div class="language-json" data-highlighter="prismjs" data-ext="json" data-title="json"><pre><code><span class="line"><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;group&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Using WebSocket functions to return entity, device, and area details&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;style&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;color&quot;</span><span class="token operator">:</span><span class="token string">&quot;#000000&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token property">&quot;nodes&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;578b1fe6b17d9053&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;9e2cc6208465cb53&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;24a0721c11a9dabf&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;0e27f1810d1f2726&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;25aa9320ec1b341f&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;87097a630683a0f3&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;2b079469d339ee68&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;6d7320ce7cf2d71b&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;4cf613030bdac458&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;4bba7af21fb76af8&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;80af7504e9450dd4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2699</span><span class="token punctuation">,</span><span class="token property">&quot;w&quot;</span><span class="token operator">:</span><span class="token number">732</span><span class="token punctuation">,</span><span class="token property">&quot;h&quot;</span><span class="token operator">:</span><span class="token number">322</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;578b1fe6b17d9053&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;inject&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Manual trigger&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;props&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;repeat&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;crontab&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;once&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;onceDelay&quot;</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token property">&quot;topic&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2820</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;9e2cc6208465cb53&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;9e2cc6208465cb53&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;ha-get-entities&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Entities with an attribute called \&quot;array\&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;server&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;rules&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;logic&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;$entity().attributes.array!=[]&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;valueType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;outputType&quot;</span><span class="token operator">:</span><span class="token string">&quot;array&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputEmptyResults&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;outputLocationType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputLocation&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputResultsCount&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">410</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2820</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;6d7320ce7cf2d71b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;24a0721c11a9dabf&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;api-current-state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Entity attributes called \&quot;array\&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;server&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_compare&quot;</span><span class="token operator">:</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;sensor.date_time&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;state_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;blockInputOverrides&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;outputProperties&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;$entities().*.attributes[$exists(array)]&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;valueType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;for&quot;</span><span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;forType&quot;</span><span class="token operator">:</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;forUnits&quot;</span><span class="token operator">:</span><span class="token string">&quot;minutes&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;override_topic&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;state_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;override_payload&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entity_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;override_data&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">380</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2900</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;4cf613030bdac458&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;0e27f1810d1f2726&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;api-current-state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Get Areas with Device and Entity Counts&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;server&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_compare&quot;</span><span class="token operator">:</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;sensor.time&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;state_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;blockInputOverrides&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;outputProperties&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;$areas()^(name).{name: \&quot; Devices: \&quot; &amp; $count($areaDevices(area_id)) &amp; \&quot; Entities: \&quot; &amp; $count($areaEntities(area_id))}~&gt;$merge()&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;valueType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;for&quot;</span><span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;forType&quot;</span><span class="token operator">:</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;forUnits&quot;</span><span class="token operator">:</span><span class="token string">&quot;minutes&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;override_topic&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;state_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;override_payload&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entity_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;override_data&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">420</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2980</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;87097a630683a0f3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;25aa9320ec1b341f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;inject&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Manual trigger&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;props&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;repeat&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;crontab&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;once&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;onceDelay&quot;</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token property">&quot;topic&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2980</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;0e27f1810d1f2726&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;87097a630683a0f3&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Output&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">670</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2980</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;2b079469d339ee68&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;inject&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Manual trigger&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;props&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;repeat&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;crontab&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;once&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;onceDelay&quot;</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token property">&quot;topic&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2900</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;24a0721c11a9dabf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;6d7320ce7cf2d71b&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Output&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">670</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2820</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;4cf613030bdac458&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Output&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">670</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2900</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;4bba7af21fb76af8&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;server-state-changed&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Using $entity() and $prevEntity()&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;server&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;exposeAsEntityConfig&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityId&quot;</span><span class="token operator">:</span><span class="token string">&quot;sensor.time&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityIdType&quot;</span><span class="token operator">:</span><span class="token string">&quot;exact&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputInitially&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;stateType&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ifState&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ifStateType&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ifStateOperator&quot;</span><span class="token operator">:</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputOnlyOnStateChange&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;for&quot;</span><span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;forType&quot;</span><span class="token operator">:</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;forUnits&quot;</span><span class="token operator">:</span><span class="token string">&quot;minutes&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ignorePrevStateNull&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;ignorePrevStateUnknown&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;ignorePrevStateUnavailable&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;ignoreCurrentStateUnknown&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;ignoreCurrentStateUnavailable&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;outputProperties&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;{\&quot;old\&quot;: $prevEntity(), \&quot;new\&quot;: $entity()}&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;valueType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">390</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2740</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;80af7504e9450dd4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;80af7504e9450dd4&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;c3f7b442994c1a29&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Output&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">670</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2740</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre></div><h3 id="reading-entity-state-and-entity-attributes-with-entity-and-preventity" tabindex="-1"><a class="header-anchor" href="#reading-entity-state-and-entity-attributes-with-entity-and-preventity"><span>Reading entity state and entity attributes with <em>$entity()</em> and <em>$prevEntity()</em></span></a></h3><p>In nodes with <em>output properties</em>, a number of properties are typically set by default, or can be optionally set as:</p><ul><li>msg.payload = &#39;<em>entity state</em>&#39;</li><li>msg.data = &#39;<em>entity</em>&#39;</li><li>msg.event = &#39;<em>event data</em>&#39;</li><li>msg.topic = &#39;<em>entity id</em>&#39;</li></ul><p>This provides useful message values in the flow <em>following</em> the node, however these values can be obtained <em>within</em> the node itself using the appropriate functions.</p><p>The function <code>$entity()</code> returns an object containing the entity details, relating to the entity that is the subject of the node. This means that the output property selection options are equivalent to JSONata expressions:</p><ul><li>&#39;<em>entity</em>&#39; ~ $entity()</li><li>&#39;<em>entity state</em>&#39; ~ $entity().state</li><li>&#39;<em>entity id</em>&#39; ~ $entity().entity_id</li></ul><p>For the <strong>Events:</strong> nodes (<em>Events: all</em> and <em>Events: state</em>) the node triggers from an entity-change event, with <em>$entity()</em> returning the current (new) entity details, and the function <code>$prevEntity()</code> returning the previous (old) entity details.</p><div class="language-text" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">{&quot;old&quot;: $prevEntity(), &quot;new&quot;: $entity()}</span>
<span class="line"></span></code></pre></div><p><strong>The first example</strong> uses an <em>Events: state</em> node, with a basic <code>sensor.time</code> entity to facilitate triggering the node every minute. The <a href="https://www.home-assistant.io/integrations/time_date/" target="_blank" rel="noopener noreferrer">Time &amp; Date Integration</a> should be added to the configuration file, and then the given time sensor will return the current local time. The entity state (as time) is &quot;hh:mm&quot; and therefore changes every 60 seconds.</p><p>The output <em>msg.payload</em> is set to a new JSONata expression, which creates a new object with the old and new entity details, just as the output property &#39;event data&#39; would do, but permitting a more detailed JSONata expression to be executed if required.</p><h3 id="using-entities-to-return-one-or-all-entities" tabindex="-1"><a class="header-anchor" href="#using-entities-to-return-one-or-all-entities"><span>Using <em>$entities()</em> to return one or all entities</span></a></h3><p><strong>The next two examples</strong> explore ways to obtain specific entities, and this code looks for all Home Assistant entities that have an attribute field called &#39;array&#39;.</p><div class="language-text" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$entity().attributes.array!=[]</span>
<span class="line"></span></code></pre></div><p>In the first flow, a <em>Get Entities</em> node is used, with a JSONata expression used to filter the result, based on each entity having an attribute field called &#39;array&#39; that is a non-empty JSON array. This will return the entire entity, and therefore the output will be an array of entities that have an &#39;attribute.array&#39; field.</p><div class="language-text" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$entities().*.attributes[$exists(array)]</span>
<span class="line"></span></code></pre></div><p>In the second flow, a <em>Current State</em> node is used, with a valid subject entity. The return from the given entity itself is not required - the node is just being used as a vehicle in which to execute the <em>$entities()</em> function. When specifying a <em>named</em> entity such as <code>$entities(&#39;sun.next_dawn&#39;)</code> only that entity will be returned, otherwise an array of all entities in Home Assistant will be returned. This JSONata expression then matches all entities in the array, filtering out attributes fields where the object key &#39;array&#39; exists.</p><p>In contrast to the preceding flow, this will return just an array of the entity attributes. The JSONata code in this case can also be executed as and when required.</p><p><strong>Note:</strong> Where a number of entity state values or attributes are required at one point in a flow for collective processing, using JSONata in a Current State node can be highly effective. The alternatives are:</p><ul><li>Several Current State nodes chained in sequence, with each writing the state or entity data to a different msg.field.</li><li>One Current State node executing a JSONata expression, collating various $entity() or $entities(&#39;sensor.name&#39;) functions to either place values into one object, or to perform the necessary computation at that point. Output from JSONata can be either a simple primitive, or an object with several fields.</li></ul><h3 id="using-areas-areadevices-and-areaentities" tabindex="-1"><a class="header-anchor" href="#using-areas-areadevices-and-areaentities"><span>Using <em>$areas()</em>, <em>$areaDevices</em> and <em>$areaEntities()</em></span></a></h3><p>Finally, a more complex JSONata expression that returns details about areas, devices, and entities.</p><div class="language-text" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$areas()^(name).{</span>
<span class="line">    name: &quot; Devices: &quot; &amp; $count($areaDevices(area_id)) &amp; &quot; Entities: &quot; &amp; $count($areaEntities(area_id))</span>
<span class="line">    } ~&gt; $merge()</span>
<span class="line"></span></code></pre></div><p>The JSONata above is just one long expression line (unnecessary new lines have been added just to make the expression easier to read). Evaluated left to right, it starts with the <code>$areas()</code> function:</p><ul><li>Without a given area lookup value, this function returns an array of all areas in Home Assistant <ul><li>which is then sorted alphabetically, by name</li></ul></li><li>The result is an array, which is mapped (iterated over)</li><li>applying an {} object constructor for each array item <ul><li>the object creates one key: value pair</li><li>the key is the area &#39;name&#39; (this is a string)</li><li>the value is a constructed text string</li></ul></li><li>The function $areaDevices(area_id) returns all devices in each area <ul><li>using &#39;area_id&#39; for the item area, and returning an array of devices</li><li>using $count() to count the number of devices in the returned array</li></ul></li><li>The function $areaEntities(area_id) returns all entities in that area <ul><li>returning an array, which is similarly counted</li></ul></li><li>The resulting array of objects is then merged into one single object</li></ul><p><strong>Also see:</strong></p><ul><li><a class="route-link" href="/node-red-contrib-home-assistant-websocket/guide/jsonata/">JSONata guide</a></li><li><a class="route-link" href="/node-red-contrib-home-assistant-websocket/guide/jsonata/jsonata-primer.html">JSONata primer</a></li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/edit/main/docs/cookbook/jsonata/functions.md" aria-label="Help us improve this page!" rel="noopener noreferrer" target="_blank"><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->Help us improve this page!<!----></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 37859597+zachowj@users.noreply.github.com">Jason</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/events-state.html" aria-label="Events: state"><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span>Events: state</span></div></a><a class="route-link auto-link next" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/sensor.html" aria-label="Sensor"><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span>Sensor</span></div></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/node-red-contrib-home-assistant-websocket/assets/app-YEeKhUZS.js" defer></script>
  </body>
</html>
